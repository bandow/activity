<!DOCTYPE html>
<html id="html" lang="zh-cmn-Hans">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<meta name="description" content="感恩日"/>
<meta name="keywords" content="感恩日"/>
<meta name="author" content="name, sycbbb@sina.com"/>
<meta name="robots" content="index,follow"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<meta name="format-detection" content="telephone=no, email=no,adress=no"/>
<meta name="msapplication-tap-highlight" content="no">
<title>感恩日</title>
<link rel="stylesheet" href="styles/index.css">
</head>
<body>
<div class="wrapper" id="wrapper" style="background:url('images/bg.jpg') #f52b5a no-repeat;background-size:100% auto;">
	<div class="logo"><img src="images/logo.png" alt=""></div>
	<div class="lotteryDraw" style="background:url('images/draw_bg.png') no-repeat; background-size:100% auto;">
		<p>已有<strong>102345</strong>人参与</p>
		<div id="lottery"> 
		    <table border="0" cellpadding="0" cellspacing="0"> 
		        <tr> 
		            <td class="lottery-unit lottery-unit-0">
			            <img src="images/learn7.png">
			            <p>体验券</p>
			            <div class="mask"></div>
		            </td> 
		            <td class="lottery-unit lottery-unit-1">
			            <img src="images/coupon10.png">
			            <p>电子优惠券</p>
			            <div class="mask"></div>
		            </td> 
		            <td class="lottery-unit lottery-unit-2">
			            <img src="images/coupon30.png">
			            <p>电子优惠券</p>
			            <div class="mask"></div>
		            </td> 
		        </tr> 
		        <tr> 
		            <td class="lottery-unit lottery-unit-8">
			            <img src="images/ticket.png">
			            <p>体验券</p>
			            <div class="mask"></div>
		            </td> 
		            <td style="background:url('images/td_bg.png') no-repeat; background-size:100% 100%;">
		            	<a href="javascript:;">点&nbsp;击抽&nbsp;奖</a>
		            	<p>今日剩余<strong>2</strong>次</p>
		            </td> 
		            <td class="lottery-unit lottery-unit-4">
			            <img src="images/free.png">
			            <p>免费房</p>
			            <div class="mask"></div>
		            </td> 
		        </tr> 
		        <tr> 
		            <td class="lottery-unit lottery-unit-7">
		            	<img src="images/integral.png">
		            	<p>体验券</p>
		            	<div class="mask"></div>
		            </td> 
		            <td class="lottery-unit lottery-unit-6">
		            	<img src="images/thanks.png">
		            	<p>谢谢参与</p>
		            	<div class="mask"></div>
		            </td> 
		            <td class="lottery-unit lottery-unit-5">
		            	<img src="images/coupon20.png">
		            	<p>积分</p>
		            	<div class="mask"></div>
		            </td> 
		        </tr> 
		    </table> 
		</div>
	</div>
	<div class="roster">
		<h3>中奖名单</h3>
		<div class="rosterList">
			<ul>
				<li><p><span>广州用户</span><span>139XXXX1234</span><span>抽中</span><span>10元满减券</span></p></li>
				<li><p><span>广州用户</span><span>139XXXX1234</span><span>抽中</span><span>20元满减券</span></p></li>
				<li><p><span>广州用户21</span><span>139XXXX1234</span><span>抽中</span><span>30元满减券</span></p></li>
				<li><p><span>广州用户72</span><span>139XXXX1234</span><span>抽中</span><span>140元满减券</span></p></li>
				<li><p><span>广州用户3</span><span>139XXXX1234</span><span>抽中</span><span>150元满减券</span></p></li>
			</ul>	
		</div>
	</div>
	<footer class="footer">
	    <a href="javascript:;" onclick="prizeMask();">我的奖品</a>
	    <a href="javascript:;" onclick="ruleMask();">活动规则</a>
	</footer>
</div>
<!-- mask begin -->
<div class="mask" onclick="maskRun();"></div>
<div class="ruleMask">
	<div class="title">
		<h3>活动规则</h3>
		<img src="images/mask_title.png" alt="">
	</div>
	<div class="content">
		<p>1、规则规则规则规则规则规则规则规则规则规则规则； </p>
		<p>2、规则规则规则规则规则规则规则规则规则则则则则则则则规则规则规则规规则规</p>
	</div>
	<div class="foot"><p>活动最终解释权由东呈国际酒店所有</p></div>
	<div class="close" onclick="closeHide();"></div>
</div>
<div class="prizeListMask">
	<div class="title">
		<h3>我的奖品</h3>
		<img src="images/mask_title.png" alt="">
	</div>
	<div class="content">
		<div class="item">
			<div class="img"><img src="images/coupon10.png" alt=""></div>
			<p>优惠券10元</p>
			<p class="not">未领取</p>
		</div>
		<div class="item">
			<div class="img"><img src="images/coupon10.png" alt=""></div>
			<p>积分</p>
			<p class="not">未领取</p>
		</div>
		<div class="item">
			<div class="img"><img src="images/coupon10.png" alt=""></div>
			<p>积分</p>
			<p>成功领取</p>
		</div>
	</div>
	<div class="close" onclick="closeHide();"></div>
</div>
<div class="successMask">
	<h3>领取成功</h3>
	<p>*奖品已绑定至会员账户</p>
</div>
<div class="prizeMask">
	<img src="images/prize_bg.png" alt="">
	<img src="images/prize_title.png" alt="">
	<div class="prizeTxt">
		<div class="text">
			<div class="img">
				<img src="images/coupon10.png" alt="">
				<p>优惠券</p>
			</div>
			<div class="textList">
				<p>恭喜你</p>
				<p>抽中<span>积分</span>一份</p>
				<p>立刻领取奖品吧</p>
			</div>
		</div>
		<a href="javascript:;" onclick="receive();">立即领取</a>
	</div>
</div>
<!-- mask end -->
<!-- script begin -->
<script src="scripts/jquery-3.1.1.min.js"></script>
<script>
	$(document).ready(function(){
		//中奖名单滚动
		$(".rosterList").height($(".rosterList p").height()*2);
        var pHeight=$(".rosterList p").height();
		function scroll(){
		   $(".rosterList ul").animate({"margin-top":-pHeight+"px"},function(){
				$(".rosterList ul li:eq(0)").appendTo($(".rosterList ul"));
				$(".rosterList ul").css({"margin-top":0});
		   })
		}
	    setInterval(scroll,1000);

	    //点击领取奖品
		$(".prizeListMask .item p:last-child").on("click",function(){	
			if($(this).hasClass("not")){
				$(this).removeClass("not").text("成功领取").parents(".prizeListMask").hide();
				successMask();
			}else{
				return false;
			}
		});

    });

    //抽奖特效
    var lottery={
	    index:-1,    //当前转动到哪个位置，起点位置
	    count:0,    //总共有多少个位置
	    timer:0,    //setTimeout的ID，用clearTimeout清除
	    speed:20,    //初始转动速度
	    times:0,    //转动次数
	    cycle:50,    //转动基本次数：即至少需要转动多少次再进入抽奖环节
	    prize:-1,    //中奖位置
	    init:function(id){
	        if ($("#"+id).find(".lottery-unit").length>0) {
	            $lottery = $("#"+id);
	            $units = $lottery.find(".lottery-unit");
	            this.obj = $lottery;
	            this.count = $units.length;
	            $lottery.find(".lottery-unit-"+this.index).addClass("active");
	        };
	    },
	    roll:function(){
	        var index = this.index;
	        var count = this.count;
	        var lottery = this.obj;
	        $(lottery).find(".lottery-unit-"+index).removeClass("active");
	        index += 1;
	        if (index>count-1) {
	            index = 0;
	        };
	        $(lottery).find(".lottery-unit-"+index).addClass("active");
	        this.index=index;
	        return false;
	    },
	    stop:function(index){
	        this.prize=index;
	        return false;
	    }
	};
	function roll(){
	    lottery.times += 1;
	    lottery.roll();//转动过程调用的是lottery的roll方法，这里是第一次调用初始化
	    if (lottery.times > lottery.cycle+10 && lottery.prize==lottery.index) {
	        clearTimeout(lottery.timer);
	        lottery.prize=-1;
	        lottery.times=0;
	        click=false;
	    }else{
	        if (lottery.times<lottery.cycle) {
	            lottery.speed -= 10;
	        }else if(lottery.times==lottery.cycle) {
	            var index = Math.random()*(lottery.count)|0;
	            lottery.prize = index;        
	        }else{
	            if (lottery.times > lottery.cycle+10 && ((lottery.prize==0 && lottery.index==7) || lottery.prize==lottery.index+1)) {
	                lottery.speed += 110;
	            }else{
	                lottery.speed += 20;
	            }
	        }
	        if (lottery.speed<40) {
	            lottery.speed=40;
	        };
	        //console.log(lottery.times+'^^^^^^'+lottery.speed+'^^^^^^^'+lottery.prize);
	        lottery.timer = setTimeout(roll,lottery.speed);//循环调用
	    }
	    return false;
	}
	var click=false;
	window.onload=function(){
	    lottery.init('lottery');
	    $("#lottery a").click(function(){
	        if (click) {//click控制一次抽奖过程中不能重复点击抽奖按钮，后面的点击不响应
	            return false;
	        }else{
	            lottery.speed=100;
	            roll();    //转圈过程不响应click事件，会将click置为false
	            click=true; //一次抽奖完成后，设置click为true，可继续抽奖
	            setTimeout(prizeLayer,4500);//中奖弹出框
	            return false;
	        }
	    });
	};

	//活动规则 rule
	function ruleMask(){
		$(".ruleMask").show();
		$(".mask").show();
	}
	//我的奖品 prize
	function prizeMask(){
		$(".prizeListMask").show();
		$(".mask").show();
	}
	//领取成功
	function successMask(){	
		$(".successMask").show();
		$(".mask").show();
	}
	//点击覆盖层
	function maskRun(){
		$(".ruleMask").hide();
		$(".prizeListMask").hide();
		$(".successMask").hide();
		$(".prizeMask").removeClass("prizeMaskActive");
		$(".mask").hide();
	}
	//点击关闭
	function closeHide(){
		$(".ruleMask").hide();
		$(".prizeListMask").hide();
		$(".mask").hide();
	}
	//中奖了
	function prizeLayer(){
		$(".mask").show();
		$(".prizeMask").addClass("prizeMaskActive");
	}
	//立即领取
	function receive(){
		$(".prizeMask").removeClass("prizeMaskActive");
		$(".mask").hide();
	}

</script>
<!-- script end -->
</body>
</html>